
CREATE TABLE technical_indicators (id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,asset_id varchar NOT NULL, date date NOT NULL,
mom_1 float,wma_10 float,ema_10 float,supert_10_2_0 float,supertd_10_2_0 float,supertl_10_2_0 float,superts_10_2_0 float,vwma_10 float,
sma_10 float,cdl_2crows float,cdl_3blackcrows float,cdl_3inside float,cdl_3linestrike float,cdl_3outside float,cdl_3starsinsouth float,
cdl_3whitesoldiers float,cdl_abandonedbaby float,cdl_advanceblock float,cdl_belthold float,cdl_breakaway float,cdl_closingmarubozu float,
cdl_concealbabyswall float,cdl_counterattack float,cdl_darkcloudcover float,cdl_doji_10_0_1 float,cdl_dojistar float,cdl_dragonflydoji float,
cdl_engulfing float,cdl_eveningdojistar float,cdl_eveningstar float,cdl_gapsidesidewhite float,cdl_gravestonedoji float,cdl_hammer float,
cdl_hangingman float,cdl_harami float,cdl_haramicross float,cdl_highwave float,cdl_hikkake float,cdl_hikkakemod float,cdl_homingpigeon float,
cdl_identical3crows float,cdl_inneck float,cdl_inside float,cdl_invertedhammer float,cdl_kicking float,cdl_kickingbylength float,
cdl_ladderbottom float,cdl_longleggeddoji float,cdl_longline float,cdl_marubozu float,cdl_matchinglow float,cdl_mathold float,
cdl_morningdojistar float,cdl_morningstar float,cdl_onneck float,cdl_piercing float,cdl_rickshawman float,cdl_risefall3methods float,
cdl_separatinglines float,cdl_shootingstar float,cdl_shortline float,cdl_spinningtop float,cdl_stalledpattern float,cdl_sticksandwich float,
cdl_takuri float,cdl_tasukigap float,cdl_thrusting float,cdl_tristar float,cdl_unique3river float,cdl_upsidegap2crows float,
cdl_xsidegap3methods float,stochk_14_3_3 float,stochd_14_3_3 float,cti_14 float,rsi_14 float,mfi_14 float,aroond_14 float,aroonu_14 float,
aroonosc_14 float,wma_20 float,ema_20 float,natr_20 float,vwma_20 float,sma_20 float,macd_12_26_9 float,macdh_12_26_9 float,
macds_12_26_9 float,bbl_5_2_0 float,bbm_5_2_0 float,bbu_5_2_0 float,bbb_5_2_0 float,bbp_5_2_0 float,wma_50 float,
ema_50 float,vwma_50 float,sma_50 float,   CONSTRAINT fk_assets
  FOREIGN KEY(asset_id)
  REFERENCES assets(symbol));
  
  
CREATE TABLE weather(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, date date NOT NULL, location varchar, maxtempC float, mintempC float, pressure float, visibility float, humidity float, windspeedKmph float, precipMM float);


CREATE TABLE news(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, asset_id varchar NOT NULL, date date NOT NULL, summary text,   CONSTRAINT fk_assets
  FOREIGN KEY(asset_id)
  REFERENCES assets(symbol));
  
  
CREATE TABLE tweets(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,asset_id varchar NOT NULL,date date NOT NULL, tweets text,   CONSTRAINT fk_assets
  FOREIGN KEY(asset_id)
  REFERENCES assets(symbol));
  
  
CREATE TABLE ratios(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,asset_id varchar NOT NULL,date date NOT NULL, eps float, opm float, roe float, pbt float, pe float, netprofit float,   CONSTRAINT fk_assets
  FOREIGN KEY(asset_id)
  REFERENCES assets(symbol));
  
  
CREATE TABLE daily_minute_prices(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,datetime timestamp NOT NULL,asset_id varchar NOT NULL, open float, high float, low float, close float,adj_close float, volume int,   CONSTRAINT fk_assets
  FOREIGN KEY(asset_id)
  REFERENCES assets(symbol));

CREATE TABLE stock_prices(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,	asset_id varchar, open float, high float, low float, close float, volume float);


CREATE TABLE ext_daily_minute_prices(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,datetime timestamp NOT NULL,asset_id varchar NOT NULL, open float, high float, low float, close float,adj_close float, volume int);


CREATE TABLE tweets_sentiment(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,asset_id varchar NOT NULL,date date NOT NULL,
tweets_sentiment float,   CONSTRAINT fk_assets
  FOREIGN KEY(asset_id)
  REFERENCES assets(symbol));
  

CREATE TABLE news_sentiment(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,asset_id varchar NOT NULL,date date NOT NULL, news_sentiment float,   CONSTRAINT fk_assets
  FOREIGN KEY(asset_id)
  REFERENCES assets(symbol));

CREATE TABLE weather_preprocessed(id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, date date NOT NULL, country varchar, maxtempC float, mintempC float, pressure float, visibility float, humidity float, windspeedKmph float, precipMM float);


CREATE TABLE assets(company_name varchar UNIQUE, industry varchar, symbol varchar, series varchar, isin_code varchar, id int, country varchar);



\COPY assets
FROM '/home/imentus/Desktop/Postgres Database/assets.csv' 
DELIMITER ',' 
CSV HEADER;


DIFFERENT WAYS TO CONNECT TO DATABASE-

|---  USING psql termial
|     psql --host=aitrading-ws-test-instance-1.cxgezshuoztq.ap-south-1.rds.amazonaws.com --port=5432 --username=postgres --password --dbname=postgres
|
|---  USING psycopg2 database driver (python)
|     conn = psycopg2.connect(
|	  database="assets",
|	  user='postgres',
|	  password='123',
|	  host='localhost',
|	  port='5432' )
|
|---  USING sqlalchemy (python)
      engine = create_engine('postgresql+psycopg2://{user}:{password}:{host}/{dbname}')


DELETE FROM assetdata.news_sentiment
WHERE id IN (
    SELECT id FROM assetdata.news_sentiment 
    EXCEPT SELECT MIN(id) FROM assetdata.news_sentiment  
    GROUP BY date, asset_id
    )
ORDER BY date, asset_id;


\COPY (select id,name from tablename) TO 'filepath/aa.csv' DELIMITER ',' CSV HEADER;
\COPY (SELECT * FROM assetdata.ext_daily_minute_prices) TO '/home/imentus/Desktop/Postgres Database/ext_daily_minute_prices.csv' DELIMITER ',' CSV HEADER;
